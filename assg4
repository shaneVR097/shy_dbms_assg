-- Step 1: Create Tables
CREATE TABLE SAILOR (SID VARCHAR(10) PRIMARY KEY, SNAME VARCHAR(50) NOT NULL, MNAME VARCHAR(50), SURNAME VARCHAR(50) NOT NULL, RATING INT NOT NULL, AGE DECIMAL(5, 1) NOT NULL);
CREATE TABLE BOAT (BID VARCHAR(10) PRIMARY KEY, BNAME VARCHAR(50) NOT NULL, COLOR VARCHAR(20) NOT NULL);
CREATE TABLE RESERVE (SID VARCHAR(10), BID VARCHAR(10), R_DAY DATE, PRIMARY KEY (SID, BID, R_DAY), FOREIGN KEY (SID) REFERENCES SAILOR(SID) ON DELETE CASCADE, FOREIGN KEY (BID) REFERENCES BOAT(BID) ON DELETE CASCADE);

-- Step 2: Insert Data into Tables
INSERT INTO SAILOR VALUES ('s22', 'Fredrico', NULL, 'Roberts', 7, 45);
INSERT INTO SAILOR VALUES ('s31', 'Lubber', NULL, 'Sheen', 8, 55.5);
INSERT INTO SAILOR VALUES ('s32', 'Charlotte', NULL, 'Gordin', 8, 25.5);
INSERT INTO SAILOR VALUES ('s22', 'Deep', 'Kumar', 'Jha', 8, 51); 
INSERT INTO BOAT VALUES ('b11', 'Interlake', 'blue');
INSERT INTO BOAT VALUES ('b12', 'Interlake', 'red');
INSERT INTO BOAT VALUES ('b13', 'Clipper', 'green');
INSERT INTO BOAT VALUES ('b14', 'Marine', 'red');
INSERT INTO RESERVE VALUES ('s22', 'b11', TO_DATE('10-OCT-1998', 'DD-MON-YYYY'));
INSERT INTO RESERVE VALUES ('s22', 'b13', TO_DATE('10-AUG-1998', 'DD-MON-YYYY'));
INSERT INTO RESERVE VALUES ('s22', 'b14', TO_DATE('10-JUL-1998', 'DD-MON-YYYY'));
INSERT INTO RESERVE VALUES ('s87', 'b12', TO_DATE('12-DEC-1998', 'DD-MON-YYYY'));

-- Step 3: Queries
SELECT SID FROM RESERVE WHERE BID = 'b14';
SELECT SNAME FROM SAILOR WHERE RATING IS NOT NULL;
SELECT SNAME FROM SAILOR WHERE RATING IS NULL;
SELECT DISTINCT B.COLOR FROM BOAT B JOIN RESERVE R ON B.BID = R.BID JOIN SAILOR S ON R.SID = S.SID WHERE S.SNAME = 'Lubber';
SELECT DISTINCT S.SNAME FROM SAILOR S JOIN RESERVE R ON S.SID = R.SID;
SELECT S.SID, S.SNAME FROM SAILOR S JOIN RESERVE R ON S.SID = R.SID GROUP BY S.SID, S.SNAME, R.R_DAY HAVING COUNT(DISTINCT R.BID) >= 2;
SELECT SNAME FROM SAILOR WHERE SNAME LIKE 'B%' AND SNAME LIKE '%B' AND LENGTH(SNAME) >= 3;
SELECT SNAME FROM SAILOR WHERE SNAME LIKE 'B%' AND SNAME LIKE '%B' AND LENGTH(SNAME) = 3;
SELECT S.SNAME FROM SAILOR S JOIN RESERVE R ON S.SID = R.SID JOIN BOAT B ON R.BID = B.BID WHERE B.COLOR = 'red' OR B.COLOR = 'green';
SELECT DISTINCT S.SNAME FROM SAILOR S JOIN RESERVE R ON S.SID = R.SID JOIN BOAT B ON R.BID = B.BID WHERE B.COLOR = 'red' OR B.COLOR = 'green';
SELECT S.SNAME FROM SAILOR S WHERE S.SID IN (SELECT R1.SID FROM RESERVE R1 JOIN BOAT B1 ON R1.BID = B1.BID WHERE B1.COLOR = 'red') AND S.SID IN (SELECT R2.SID FROM RESERVE R2 JOIN BOAT B2 ON R2.BID = B2.BID WHERE B2.COLOR = 'green');
SELECT S.SNAME FROM SAILOR S JOIN RESERVE R ON S.SID = R.SID JOIN BOAT B ON R.BID = B.BID WHERE B.COLOR = 'red' AND S.SID NOT IN (SELECT R2.SID FROM RESERVE R2 JOIN BOAT B2 ON R2.BID = B2.BID WHERE B2.COLOR = 'green');
